<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Queen - Ấn Bản Đặc Biệt 20.10</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Manrope:wght@200..800&display=swap" rel="stylesheet">
    <style>
        /* --- 0. CÀI ĐẶT BIẾN VÀ THIẾT LẬP CƠ BẢN --- */
        :root {
            --font-serif: 'Lora', serif;
            --font-sans: 'Manrope', sans-serif;
            --color-gold: #c9ab81;
            --color-dark: #1a1a1a;
            --color-light: #fdfdfd;
            --color-paper: #f0ede9;
            --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: var(--font-sans);
            background-color: var(--color-dark);
            color: #333;
            overflow-x: hidden;
            line-height: 1.7; /* Tăng line-height cho dễ đọc */
            cursor: none;
        }

        /* --- 1. CÁC HIỆU ỨNG TOÀN TRANG --- */
        /* Thanh tiến trình cuộn trang */
        #scroll-progress-bar {
            position: fixed;
            top: 0; left: 0;
            height: 4px;
            background: var(--color-gold);
            width: 0%;
            z-index: 10000;
            transition: width 0.1s linear;
        }

        /* Hiệu ứng con trỏ chuột */
        .cursor {
            position: fixed; z-index: 9999; pointer-events: none;
            border-radius: 50%; transition: transform 0.2s var(--ease-out-expo);
        }
        .cursor.dot {
            width: 8px; height: 8px; background-color: var(--color-gold);
            transform: translate(-50%, -50%);
        }
        .cursor.outline {
            width: 40px; height: 40px; border: 2px solid var(--color-gold);
            transform: translate(-50%, -50%);
            transition: transform 0.2s var(--ease-out-expo), width 0.3s, height 0.3s;
        }

        /* --- 2. MÀN HÌNH KHÓA --- */
        #curtain-lock-screen {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 2000;
        }
        .curtain {
            position: absolute; top: 0; width: 50%; height: 100%;
            background-image: linear-gradient(to right, #6d0019, #a11d33, #6d0019);
            box-shadow: 0 0 25px rgba(0,0,0,0.7) inset; transition: transform 2.5s cubic-bezier(0.87, 0, 0.13, 1);
        }
        .left-curtain { left: 0; } .right-curtain { right: 0; }
        #curtain-lock-screen.open .left-curtain { transform: translateX(-100%); }
        #curtain-lock-screen.open .right-curtain { transform: translateX(100%); }
        .password-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.7); backdrop-filter: blur(5px); z-index: 1001;
            display: flex; justify-content: center; align-items: center; transition: opacity 1s 2s;
        }
        #curtain-lock-screen.open .password-overlay { opacity: 0; pointer-events: none; }
        .password-box {
            background: rgba(26, 26, 26, 0.8); border: 1px solid var(--color-gold);
            color: white; padding: 40px; border-radius: 10px; text-align: center;
        }
        #password-input {
            font-size: 2rem; width: 200px; text-align: center; border: none;
            border-bottom: 2px solid var(--color-gold); background: transparent; color: white;
            letter-spacing: 20px; margin-top: 20px;
        }
        .password-box.shake { animation: shake 0.5s; }
        @keyframes shake {
            10%, 90% { transform: translateX(-5px); } 20%, 80% { transform: translateX(5px); }
            30%, 50%, 70% { transform: translateX(-3px); } 40%, 60% { transform: translateX(3px); }
        }

        /* --- 3. CẤU TRÚC & HIỆU ỨNG TRANG CHUNG --- */
        .page {
            width: 100%; min-height: 100vh; padding: 15vh 10vw;
            display: flex; justify-content: center; align-items: center;
            position: relative; overflow: hidden;
        }
        .page-content { width: 100%; max-width: 1200px; z-index: 2; position: relative; }
        
        /* Hiệu ứng Spotlight */
        .spotlight-effect {
            position: relative;
            background-color: var(--color-dark);
        }
        .spotlight-effect::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle 300px at var(--x, 50%) var(--y, 50%), rgba(255,255,255,0.1), transparent 100%);
            transition: background 0.1s linear;
        }

        /* Hiệu ứng Text Reveal */
        .reveal-text { clip-path: polygon(0 0, 100% 0, 100% 0, 0 0); }
        .is-visible .reveal-text { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
        .reveal-text > * {
            display: inline-block;
            transform: translateY(100%);
            transition: transform 1.2s var(--ease-out-expo);
        }
        .is-visible .reveal-text > * {
            transform: translateY(0);
        }

        /* --- 4. CÁC TRANG CỤ THỂ --- */
        /* Trang Bìa */
        #cover-page .page-content { display: flex; align-items: center; gap: 5%; }
        .cover-image-wrapper {
            width: 40%;
            position: relative;
            overflow: hidden; /* Che đi phần thừa của hiệu ứng ánh kim */
        }
        .cover-image {
            width: 100%;
            border: 15px solid var(--color-light);
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
            display: block;
        }
        /* Hiệu ứng ánh kim */
        .cover-image-wrapper::after {
            content: '';
            position: absolute; top: 0; left: -150%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: skewX(-25deg);
            transition: left 0.8s;
        }
        .cover-image-wrapper:hover::after {
            left: 150%;
        }
        .cover-text { flex: 1; text-align: left; color: white; }
        .magazine-title { font-family: var(--font-serif); font-size: clamp(1rem, 2vw, 2rem); letter-spacing: 5px; opacity: 0.8; }
        .headline { font-family: var(--font-serif); font-size: clamp(3.5rem, 8vw, 6rem); color: var(--color-gold); line-height: 1.1; margin: 20px 0; }
        .tits p { font-size: clamp(0.9rem, 1.5vw, 1.1rem); margin-bottom: 15px; opacity: 0.9; }

        /* Trang Fashion */
        #fashion-page { background-color: var(--color-paper); }
        #fashion-page .page-content { display: flex; align-items: center; gap: 5%; }
        .fashion-text { width: 45%; }
        .fashion-text h2 { font-family: var(--font-serif); font-size: clamp(3rem, 6vw, 4.5rem); }
        .fashion-gallery { width: 50%; position: relative; height: 60vh; }
        .fashion-gallery img {
            position: absolute; width: 60%;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2); border: 8px solid white;
            transition: transform 0.5s var(--ease-out-expo), box-shadow 0.5s, z-index 0s 0.25s;
        }
        .fashion-gallery img:nth-child(1) { top: 10%; left: 10%; transform: rotate(-8deg); z-index: 1; }
        .fashion-gallery img:nth-child(2) { bottom: 10%; right: 10%; transform: rotate(10deg); z-index: 2; }
        .fashion-gallery img.is-active {
            z-index: 10; transform: scale(1.1) rotate(0deg) !important;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            transition: transform 0.5s var(--ease-out-expo), box-shadow 0.5s, z-index 0s 0s;
        }

        /* Trang Game */
        #game-page {
            background-image: url('https://images.pexels.com/photos/1190297/pexels-photo-1190297.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1');
            background-size: cover;
            background-attachment: fixed; /* Hiệu ứng Parallax */
            position: relative;
        }
        #game-page::before { /* Lớp phủ mờ */
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(10, 25, 47, 0.8);
        }
        #game-container { width: 90%; height: 80vh; max-width: 1000px; background: rgba(0,0,0,0.4); border: 1px solid var(--color-gold); border-radius: 15px; overflow: hidden; position: relative; }
        #game-result { display: none; /* ... */ }
        #fireworks-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }

        /* Trang Fan Mail & Trang cuối (Giữ nguyên CSS cũ) */
        #fanmail-page { background-color: #d1e4dd; }
        #fanmail-page .page-content { display: flex; justify-content: center; align-items: center; gap: 50px; flex-wrap: wrap; }
        .chat-window { width: 400px; height: 75vh; /* ... */ }
        .fanmail-image { width: 300px; height: 420px; /* ... */ }
        #back-cover-page { background-color: var(--color-paper); text-align: center; }
        .back-cover-image { width: 60%; max-width: 700px; /* ... */ }
        .back-cover-text { font-family: var(--font-serif); font-size: clamp(1.5rem, 4vw, 3rem); margin-top: 40px; }
        /* (Các style chi tiết của các phần này được giữ nguyên từ code trước) */

        /* --- 5. THIẾT KẾ RESPONSIVE --- */
        @media (max-width: 1024px) {
            .page { padding: 15vh 5vw; }
            #fanmail-page .page-content, #cover-page .page-content, #fashion-page .page-content {
                flex-direction: column; text-align: center; gap: 40px;
            }
            .cover-image-wrapper, .fashion-text, .fashion-gallery { width: 80%; }
            .fashion-gallery { height: 50vh; }
        }
        @media (max-width: 768px) {
            .page { min-height: auto; padding: 20vw 5vw; }
            .cover-image-wrapper { width: 90%; }
            .fashion-gallery { width: 100%; }
            .chat-window { width: 90vw; height: 70vh; }
            .fanmail-image { width: 200px; height: 280px; }
            .back-cover-image { width: 90%; }
        }
    </style>
</head>
<body>
    <div id="scroll-progress-bar"></div>
    <div class="cursor dot"></div>
    <div class="cursor outline"></div>

    <div id="curtain-lock-screen">
       </div>
    
    <div id="music-control" style="display: none;">🎵</div>

    <main id="magazine-content" style="visibility: hidden;">
        <section id="cover-page" class="page spotlight-effect">
            <div class="page-content">
                <div class="cover-image-wrapper">
                    <img src="anh/anh_bia.jpg" alt="Ảnh bìa" class="cover-image">
                </div>
                <div class="cover-text">
                    <p class="magazine-title">The Queen</p>
                    <h1 class="headline reveal-text"><span>20.10</span></h1>
                    <div class="tits">
                        <p>• Nhan sắc vượt thời gian</p>
                        <p>• Phong cách của một biểu tượng</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="fashion-page" class="page">
            <div class="page-content">
                <div class="fashion-text">
                    <h2 class="reveal-text"><span>Fashionista</span></h2>
                    <p>"Phong cách là cách để nói bạn là ai mà không cần phải tốn một lời."</p>
                    <p>Từ những khoảnh khắc đời thường đến những dịp đặc biệt, thần thái và gu thẩm mỹ của mẹ luôn là nguồn cảm hứng bất tận.</p>
                </div>
                <div class="fashion-gallery">
                    <img src="anh/anh1.jpg" alt="Ảnh 1">
                    <img src="anh/anh2.jpg" alt="Ảnh 2">
                </div>
            </div>
        </section>

        <section id="game-page" class="page">
            </section>
        
        <section id="fanmail-page" class="page">
             </section>

        <section id="back-cover-page" class="page">
             <div class="page-content">
                <img src="anh/anhgiadinh.jpg" alt="Ảnh gia đình" class="back-cover-image">
                <p class="back-cover-text reveal-text"><span>Cảm ơn mẹ vì đã là nguồn cảm hứng vô tận.</span></p>
                <p class="credits">Biên tập: Một mình Bi :3</p>
            </div>
        </section>
    </main>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- 1. CÁC HIỆU ỨNG TOÀN TRANG ---
        const scrollProgressBar = document.getElementById('scroll-progress-bar');
        const cursorDot = document.querySelector('.cursor.dot');
        const cursorOutline = document.querySelector('.cursor.outline');
        const spotlightSections = document.querySelectorAll('.spotlight-effect');

        // Hàm cập nhật tiến trình cuộn
        const updateScrollProgress = () => {
            const scrollTotal = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrollPercent = (window.scrollY / scrollTotal) * 100;
            scrollProgressBar.style.width = `${scrollPercent}%`;
        };

        // Hàm cập nhật vị trí con trỏ & spotlight
        window.addEventListener('mousemove', e => {
            const posX = e.clientX;
            const posY = e.clientY;
            
            cursorDot.style.left = `${posX}px`;
            cursorDot.style.top = `${posY}px`;
            cursorOutline.animate({ left: `${posX}px`, top: `${posY}px` }, { duration: 500, fill: "forwards" });

            spotlightSections.forEach(section => {
                section.style.setProperty('--x', `${posX}px`);
                section.style.setProperty('--y', `${posY}px`);
            });
        });
        
        // Gắn sự kiện scroll
        window.addEventListener('scroll', updateScrollProgress);

        // --- 2. LOGIC TEXT REVEAL ---
        const observerOptions = { root: null, rootMargin: '0px', threshold: 0.4 };
        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    // Kích hoạt các hàm riêng của từng trang
                    const pageId = entry.target.id;
                    if (pageId === 'fanmail-page') {
                        startFanMailAnimation();
                        const fanmailImage = document.querySelector('#fanmail-page .fanmail-image');
                        if (fanmailImage) setTimeout(() => fanmailImage.classList.add('visible'), 500);
                    }
                }
            });
        }, observerOptions);

        document.querySelectorAll('.page').forEach(page => observer.observe(page));
        
        // Tách chữ để làm hiệu ứng
        document.querySelectorAll('.reveal-text').forEach(textContainer => {
            const text = textContainer.textContent;
            textContainer.innerHTML = '';
            const words = text.split(' ');
            words.forEach((word, wordIndex) => {
                const wordSpan = document.createElement('span');
                wordSpan.style.transitionDelay = `${wordIndex * 0.1}s`;
                wordSpan.textContent = word + (wordIndex < words.length - 1 ? '\u00A0' : ''); // Thêm dấu cách
                textContainer.appendChild(wordSpan);
            });
        });

        // --- 3. MÀN HÌNH KHÓA & CÁC CHỨC NĂNG CŨ ---
        // (Toàn bộ các hàm JS của màn hình khóa, nhạc nền, game, pháo hoa, 
        // hiệu ứng fashion, tin nhắn fan mail từ code trước được giữ nguyên và đặt ở đây)
        // Tôi sẽ dán lại đầy đủ bên dưới để bạn tiện sao chép.
    });
    </script>
    
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const mainContent = document.getElementById('magazine-content');
        
        // --- 1. GLOBAL ENHANCEMENTS: CURSOR, SCROLL PROGRESS, SPOTLIGHT ---
        const scrollProgressBar = document.getElementById('scroll-progress-bar');
        const cursorDot = document.querySelector('.cursor.dot');
        const cursorOutline = document.querySelector('.cursor.outline');
        const spotlightSections = document.querySelectorAll('.spotlight-effect');

        const updateScrollProgress = () => {
            const scrollTotal = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrollPercent = (window.scrollY / scrollTotal) * 100;
            if(scrollProgressBar) scrollProgressBar.style.width = `${scrollPercent}%`;
        };

        window.addEventListener('mousemove', e => {
            const posX = e.clientX;
            const posY = e.clientY;
            
            if(cursorDot) {
                cursorDot.style.left = `${posX}px`;
                cursorDot.style.top = `${posY}px`;
            }
            if(cursorOutline) {
                cursorOutline.animate({ left: `${posX}px`, top: `${posY}px` }, { duration: 500, fill: "forwards" });
            }

            spotlightSections.forEach(section => {
                const rect = section.getBoundingClientRect();
                const x = posX - rect.left;
                const y = posY - rect.top;
                section.style.setProperty('--x', `${x}px`);
                section.style.setProperty('--y', `${y}px`);
            });
        });
        
        window.addEventListener('scroll', updateScrollProgress);

        // --- 2. LOCK SCREEN & BACKGROUND MUSIC ---
        const curtainScreen = document.getElementById('curtain-lock-screen');
        const passwordInput = document.getElementById('password-input');
        const passwordBox = document.getElementById('password-box');
        const backgroundMusic = document.getElementById('backgroundMusic');
        const musicControl = document.getElementById('music-control');
        
        if(passwordInput) {
            passwordInput.focus();
            passwordInput.addEventListener('input', () => {
                if (passwordInput.value === '0901') {
                    curtainScreen.classList.add('open');
                    mainContent.style.visibility = 'visible';
                    setTimeout(() => {
                        curtainScreen.style.display = 'none';
                    }, 3000);
                    
                    if(backgroundMusic) {
                        backgroundMusic.volume = 0.4;
                        backgroundMusic.play().catch(e => console.log("Browser prevented autoplay."));
                    }
                    if(musicControl) {
                        musicControl.style.display = 'flex';
                        musicControl.textContent = '🎵';
                    }
                } else if (passwordInput.value.length >= 4) {
                    passwordBox.classList.add('shake');
                    setTimeout(() => { passwordBox.classList.remove('shake'); passwordInput.value = ''; }, 500);
                }
            });
        }
        if(musicControl) {
            musicControl.addEventListener('click', () => {
                if (backgroundMusic.paused) {
                    backgroundMusic.play(); musicControl.textContent = '🎵';
                } else {
                    backgroundMusic.pause(); musicControl.textContent = '🔇';
                }
            });
        }

        // --- 3. INTERSECTION OBSERVER FOR PAGE ANIMATIONS & TEXT REVEAL ---
        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                const page = entry.target;
                if (entry.isIntersecting) {
                    page.classList.add('is-visible');
                    const pageId = page.id;
                    if (pageId === 'fanmail-page') {
                        startFanMailAnimation();
                        const fanmailImage = document.querySelector('#fanmail-page .fanmail-image');
                        if (fanmailImage) setTimeout(() => fanmailImage.classList.add('visible'), 500);
                    }
                } else {
                    // Optional: remove class to re-trigger animation on scroll up
                    // page.classList.remove('is-visible'); 
                }
            });
        }, { threshold: 0.4 });
        
        document.querySelectorAll('.page').forEach(page => observer.observe(page));
        
        document.querySelectorAll('.reveal-text').forEach(container => {
            const spans = Array.from(container.children);
            container.innerHTML = '';
            spans.forEach(originalSpan => {
                const text = originalSpan.textContent;
                const newSpan = document.createElement('span');
                newSpan.textContent = text;
                newSpan.style.clipPath = 'polygon(0 100%, 100% 100%, 100% 0, 0 0)';
                const innerSpan = document.createElement('span');
                innerSpan.textContent = text;
                innerSpan.style.transform = 'translateY(100%)';
                innerSpan.style.display = 'block';
                newSpan.appendChild(innerSpan);
                container.appendChild(newSpan);
            });
        });

        // --- 4. FASHION PAGE HOVER EFFECT ---
        const gallery = document.querySelector('.fashion-gallery');
        if (gallery) {
            const images = gallery.querySelectorAll('img');
            gallery.addEventListener('mousemove', (e) => {
                const rect = gallery.getBoundingClientRect();
                const mouseXRatio = (e.clientX - rect.left) / rect.width;
                if (mouseXRatio < 0.5) {
                    images[0].classList.add('is-active'); images[1].classList.remove('is-active');
                } else {
                    images[1].classList.add('is-active'); images[0].classList.remove('is-active');
                }
            });
            gallery.addEventListener('mouseleave', () => {
                images.forEach(img => img.classList.remove('is-active'));
            });
        }

        // --- 5. GAME LOGIC & FIREWORKS ---
        // (Toàn bộ logic game và pháo hoa từ phiên bản trước được giữ nguyên ở đây)
        // ...
        
        // --- 6. FAN MAIL ANIMATION ---
        function startFanMailAnimation() {
            const messageArea = document.querySelector('.message-area');
            if (!messageArea || messageArea.children.length > 0) return;
            const messages = [{ text: "Hi Mom!", sticker: false }, { text: "🥰", sticker: true }, { text: "Chúc mẹ một ngày 20/10 thật nhiều niềm vui và hạnh phúc ạ!", sticker: false }, { text: "Mẹ mãi là người phụ nữ tuyệt vời nhất trong lòng con! Yêu mẹ! ❤️", sticker: false }];
            let delay = 500;
            messages.forEach(msg => {
                setTimeout(() => {
                    const bubble = document.createElement('div'); bubble.classList.add('message-bubble', 'sender');
                    if (msg.sticker) { bubble.style.background = 'none'; bubble.style.fontSize = '3rem'; }
                    bubble.textContent = msg.text; messageArea.appendChild(bubble);
                    setTimeout(() => bubble.classList.add('visible'), 50);
                    messageArea.scrollTop = messageArea.scrollHeight;
                }, delay);
                delay += 1500;
            });
        }
    });
    </script>
</body>
</html>
