<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Queen - Ấn Bản Đặc Biệt 20.10</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Manrope:wght@200..800&display=swap" rel="stylesheet">
    <style>
        :root {
            --font-serif: 'Lora', serif;
            --font-sans: 'Manrope', sans-serif;
            --color-gold: #c9ab81;
            --color-dark: #1a1a1a;
            --color-light: #fdfdfd;
            --color-text: #333;
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: var(--font-sans);
            background-color: var(--color-dark);
            color: var(--color-text);
            overflow-x: hidden;
        }
        
        /* --- MÀN RÈM KHÓA --- */
        #curtain-lock-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 2000;
        }
        .curtain {
            position: absolute;
            top: 0;
            width: 50%;
            height: 100%;
            background-image: linear-gradient(to right, #6d0019, #a11d33, #6d0019);
            box-shadow: 0 0 25px rgba(0,0,0,0.7) inset;
            transition: transform 2.5s cubic-bezier(0.87, 0, 0.13, 1);
        }
        .curtain::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(0,0,0,0.4) 0%, transparent 20%, transparent 80%, rgba(0,0,0,0.6) 100%),
                        url('https://www.transparenttextures.com/patterns/fabric-of-squares.png');
        }
        .left-curtain { left: 0; }
        .right-curtain { right: 0; }
        #curtain-lock-screen.open .left-curtain { transform: translateX(-100%); }
        #curtain-lock-screen.open .right-curtain { transform: translateX(100%); }

        .password-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.7); backdrop-filter: blur(5px);
            z-index: 1001; display: flex; justify-content: center; align-items: center;
            transition: opacity 1s 2s; /* Delay hiding */
        }
        #curtain-lock-screen.open .password-overlay { opacity: 0; pointer-events: none; }
        .password-box {
            background: rgba(26, 26, 26, 0.8); border: 1px solid var(--color-gold);
            color: white; padding: 40px; border-radius: 10px; text-align: center;
        }
        #password-input {
            font-size: 2rem; width: 200px; text-align: center; border: none;
            border-bottom: 2px solid var(--color-gold); background: transparent; color: white;
            letter-spacing: 20px; margin-top: 20px;
        }
        #password-input:focus { outline: none; }
        .password-box.shake { animation: shake 0.5s; }
        @keyframes shake {
            10%, 90% { transform: translateX(-5px); } 20%, 80% { transform: translateX(5px); }
            30%, 50%, 70% { transform: translateX(-3px); } 40%, 60% { transform: translateX(3px); }
        }

        /* --- CẤU TRÚC TRANG & HIỆU ỨNG --- */
        .page {
            width: 100%;
            min-height: 100vh;
            padding: 10vh 10vw;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }
        .page-content {
            width: 100%;
            max-width: 1200px;
            z-index: 2;
        }
        .animated {
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 1s, transform 1s;
        }
        .is-visible .animated {
            opacity: 1;
            transform: translateY(0);
        }
        .animated.delay-1 { transition-delay: 0.2s; }
        .animated.delay-2 { transition-delay: 0.4s; }
        .animated.delay-3 { transition-delay: 0.6s; }

        /* --- Trang Bìa --- */
        #cover-page { background-color: var(--color-dark); color: white; }
        #cover-page .page-content { display: flex; align-items: center; gap: 5%; }
        .cover-image { width: 35%; border: 15px solid var(--color-light); box-shadow: 0 0 30px rgba(0,0,0,0.5); }
        .cover-text { flex: 1; text-align: left; }
        .magazine-title { font-family: var(--font-serif); font-size: 2rem; letter-spacing: 5px; opacity: 0.8; }
        .headline { font-family: var(--font-serif); font-size: 6rem; color: var(--color-gold); line-height: 1.1; margin: 20px 0; }
        .tits p { font-size: 1.1rem; margin-bottom: 15px; opacity: 0.9; }

        /* --- Trang Fashion --- */
        #fashion-page { background-color: var(--color-light); }
        #fashion-page .page-content { display: flex; align-items: center; gap: 5%; }
        .fashion-text { width: 45%; }
        .fashion-text h2 { font-family: var(--font-serif); font-size: 4.5rem; color: var(--color-dark); }
        .fashion-text .quote { font-style: italic; font-size: 1.2rem; margin: 30px 0; padding-left: 20px; border-left: 3px solid var(--color-gold); }
        .fashion-gallery {
            width: 50%;
            position: relative;
            height: 60vh;
        }
        .fashion-gallery img {
            position: absolute;
            width: 60%;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
            transition: 0.5s;
        }
        .fashion-gallery img:nth-child(1) { top: 0; left: 0; transform: rotate(-5deg); }
        .fashion-gallery img:nth-child(2) { bottom: 0; right: 0; transform: rotate(8deg); }
        .fashion-gallery:hover img { transform: rotate(0) scale(1.05); box-shadow: 0 20px 40px rgba(0,0,0,0.3); }

        /* --- Trang Game --- */
        #game-page {
            background-image: linear-gradient(rgba(10, 25, 47, 0.9), rgba(10, 25, 47, 0.9)), url('https://images.pexels.com/photos/1190297/pexels-photo-1190297.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1');
            background-size: cover;
            background-attachment: fixed; /* Parallax effect */
            color: white;
            text-align: center;
        }
        #game-container {
            width: 90%;
            height: 80vh;
            max-width: 1000px;
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--color-gold);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        #gameCanvas { width: 100%; height: 100%; }
        #game-score { position: absolute; top: 20px; left: 30px; font-size: 2.5rem; font-family: var(--font-serif); text-shadow: 0 0 10px black; }
        #game-rules-popup, #game-result {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(5px);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        #game-rules-popup h3, #game-result h3 { font-family: var(--font-serif); font-size: 4rem; color: var(--color-gold); }
        #game-rules-popup button {
            padding: 15px 30px; font-size: 1.2rem; border: none; border-radius: 50px;
            background: var(--color-gold); color: var(--color-dark); cursor: pointer; font-weight: 600; margin-top: 20px;
        }
        #game-result { display: none; }

        /* --- Trang Fan Mail --- */
        #fanmail-page { background-color: #e5ddd5; }
        .chat-window {
            width: 400px;
            height: 75vh;
            background-color: #f0f2f5;
            border: 10px solid black;
            border-radius: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: flex; flex-direction: column;
        }
        .chat-header { padding: 15px; text-align: center; background: #005C4B; color: white; font-weight: 600; border-top-left-radius: 30px; border-top-right-radius: 30px; }
        .message-area { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .message-bubble { padding: 10px 15px; border-radius: 18px; max-width: 70%; line-height: 1.5; opacity: 0; transform: translateY(20px); transition: 0.5s; }
        .message-bubble.visible { opacity: 1; transform: translateY(0); }
        .message-bubble.sender { background-color: #dcf8c6; align-self: flex-end; border-bottom-right-radius: 4px; color: black; }
        
        /* --- Trang Cuối --- */
        #back-cover-page {
            background-color: var(--color-light);
            text-align: center;
        }
        .back-cover-image { width: 60%; max-width: 700px; border: 20px solid white; box-shadow: 0 10px 40px rgba(0,0,0,0.2); }
        .back-cover-text { font-family: var(--font-serif); font-size: 3rem; margin-top: 40px; }
        .credits { font-size: 1rem; font-style: italic; color: #777; margin-top: 20px; }
    </style>
</head>
<body>
    <div id="curtain-lock-screen">
        <div class="curtain left-curtain"></div>
        <div class="curtain right-curtain"></div>
        <div class="password-overlay" id="password-overlay">
            <div class="password-box" id="password-box">
                <h2>Một Món Quà Bất Ngờ</h2>
                <p>Nhập mật khẩu (ddmm)</p>
                <input type="password" id="password-input" maxlength="4" autocomplete="off">
            </div>
        </div>
    </div>

    <main id="magazine-content">
        <section id="cover-page" class="page">
            <div class="page-content">
                <img src="https://images.placeholders.dev/?width=600&height=800&text=Ảnh%20thần%20thái%20nhất%20của%20Mẹ&bgColor=#cccccc" alt="Ảnh bìa" class="cover-image animated">
                <div class="cover-text">
                    <p class="magazine-title animated delay-1">The Queen</p>
                    <h1 class="headline animated delay-2">20.10</h1>
                    <div class="tits animated delay-3">
                        <p>• Nhan sắc vượt thời gian</p>
                        <p>• Phong cách của một biểu tượng</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="fashion-page" class="page">
            <div class="page-content">
                <div class="fashion-text">
                    <h2 class="animated">Fashionista</h2>
                    <p class="quote animated delay-1">"Phong cách là cách để nói bạn là ai mà không cần phải tốn một lời."</p>
                    <p class="animated delay-2">Từ những khoảnh khắc đời thường đến những dịp đặc biệt, thần thái và gu thẩm mỹ của mẹ luôn là nguồn cảm hứng bất tận.</p>
                </div>
                <div class="fashion-gallery animated delay-3">
                    <img src="https://images.placeholders.dev/?width=400&height=500&text=Ảnh%20tự%20nhiên&bgColor=#F0F0F0" alt="Ảnh 1">
                    <img src="https://images.placeholders.dev/?width=400&height=500&text=Ảnh%20nụ%20cười&bgColor=#E0E0E0" alt="Ảnh 2">
                </div>
            </div>
        </section>

        <section id="game-page" class="page">
            <div class="page-content">
                <div id="game-container">
                    <canvas id="gameCanvas"></canvas>
                    <div id="game-score">Điểm: 0</div>
                    <div id="game-rules-popup">
                        <h3>Idol Challenge</h3>
                        <p>Di chuyển 🎤 để hứng quà, né bom!<br>Đạt 80 điểm để chiến thắng!</p>
                        <button id="startGameBtn">Bắt đầu!</button>
                    </div>
                    <div id="game-result"><h3 id="result-message"></h3></div>
                </div>
            </div>
        </section>
        
        <section id="fanmail-page" class="page">
            <div class="page-content">
                <div class="chat-window animated">
                    <div class="chat-header">Tin nhắn từ Fan Cứng</div>
                    <div class="message-area"></div>
                </div>
            </div>
        </section>

        <section id="back-cover-page" class="page">
             <div class="page-content">
                <img src="https://images.placeholders.dev/?width=800&height=600&text=Ảnh%20cả%20gia%20đình&bgColor=#FFFFFF" alt="Ảnh gia đình" class="back-cover-image animated">
                <p class="back-cover-text animated delay-1">Cảm ơn mẹ vì đã là nguồn cảm hứng vô tận.</p>
                <p class="credits animated delay-2">Biên tập: Một mình Bi :3</p>
            </div>
        </section>
    </main>

    <audio id="gameMusic" src="https://cdn.pixabay.com/audio/2022/08/03/audio_51cf531278.mp3" loop></audio>
    <audio id="collectSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_2b33a52239.mp3"></audio>
    <audio id="bombSound" src="https://cdn.pixabay.com/audio/2021/08/04/audio_c483740443.mp3"></audio>
    <audio id="winSound" src="https://cdn.pixabay.com/audio/2022/11/17/audio_88b22280a5.mp3"></audio>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- MÀN HÌNH KHÓA ---
        const curtainScreen = document.getElementById('curtain-lock-screen');
        const passwordInput = document.getElementById('password-input');
        const passwordBox = document.getElementById('password-box');
        passwordInput.addEventListener('input', () => {
            if (passwordInput.value === '0901') {
                curtainScreen.classList.add('open');
                setTimeout(() => curtainScreen.style.display = 'none', 3000);
            } else if (passwordInput.value.length >= 4) {
                passwordBox.classList.add('shake');
                setTimeout(() => { passwordBox.classList.remove('shake'); passwordInput.value = ''; }, 500);
            }
        });

        // --- HIỆU ỨNG KHI CUỘN ---
        const pages = document.querySelectorAll('.page');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    if (entry.target.id === 'fanmail-page') {
                        startFanMailAnimation();
                    }
                }
            });
        }, { threshold: 0.2 });
        pages.forEach(page => observer.observe(page));

        // --- GAME LOGIC ---
        const gameContainer = document.getElementById('game-container');
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('game-score');
        const rulesPopup = document.getElementById('game-rules-popup');
        const resultScreen = document.getElementById('game-result');
        const resultMessage = document.getElementById('result-message');
        const audio = {
            music: document.getElementById('gameMusic'),
            collect: document.getElementById('collectSound'),
            bomb: document.getElementById('bombSound'),
            win: document.getElementById('winSound')
        };
        let score, player, items, gameLoopId, itemInterval;

        function resizeCanvas() {
            canvas.width = gameContainer.clientWidth;
            canvas.height = gameContainer.clientHeight;
        }

        document.getElementById('startGameBtn').addEventListener('click', () => {
            rulesPopup.style.display = 'none';
            resizeCanvas();
            startGame();
        });

        function startGame() {
            score = 0; items = []; gameLoopId = null;
            scoreEl.textContent = `Điểm: ${score}`;
            player = { x: canvas.width / 2 - 25, y: canvas.height - 70, width: 50, height: 60, emoji: '🎤' };
            audio.music.play();
            itemInterval = setInterval(spawnItem, 500);
            gameLoopId = requestAnimationFrame(gameLoop);
        }

        function gameLoop() {
            updateGame();
            if(gameLoopId) requestAnimationFrame(gameLoop);
        }

        const itemTypes = [
            { emoji: '❤️', value: 5, type: 'good' }, { emoji: '⭐', value: 10, type: 'good' },
            { emoji: '💣', value: -5, type: 'bad' }
        ];

        function spawnItem() {
            const type = itemTypes[Math.floor(Math.random() * 2.5)]; // higher chance of good items
            items.push({ x: Math.random() * (canvas.width - 40), y: -40, size: 40, speed: 2 + Math.random() * 3, ...type });
        }

        function updateGame() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.font = '50px sans-serif';
            ctx.fillText(player.emoji, player.x, player.y);
            items.forEach((item, index) => {
                item.y += item.speed;
                ctx.font = `${item.size}px sans-serif`;
                ctx.fillText(item.emoji, item.x, item.y);
                if (item.y > canvas.height) items.splice(index, 1);
                if (player.x < item.x + item.size && player.x + player.width > item.x && player.y < item.y + item.size && player.y + player.height > item.y) {
                    score = Math.max(0, score + item.value);
                    scoreEl.textContent = `Điểm: ${score}`;
                    items.splice(index, 1);
                    (item.type === 'good' ? audio.collect : audio.bomb).play();
                    if (score >= 80) endGame(true);
                }
            });
        }

        function endGame(isWin) {
            cancelAnimationFrame(gameLoopId);
            gameLoopId = null;
            clearInterval(itemInterval);
            audio.music.pause();
            resultScreen.style.display = 'flex';
            resultMessage.textContent = isWin ? "XUẤT SẮC!" : "Cố Lên Nào!";
            if (isWin) audio.win.play();
        }

        document.addEventListener('keydown', e => {
            if (!player) return;
            if (e.key === 'ArrowLeft' && player.x > 0) player.x -= 30;
            if (e.key === 'ArrowRight' && player.x < canvas.width - player.width) player.x += 30;
        });
        canvas.addEventListener('touchmove', e => {
            if (!player) return;
            e.preventDefault();
            const rect = canvas.getBoundingClientRect();
            player.x = e.touches[0].clientX - rect.left - player.width / 2;
        });

        // --- FAN MAIL ANIMATION ---
        const messages = [
            { text: "Hi Mom!", sticker: false }, { text: "🥰", sticker: true },
            { text: "Chúc mẹ một ngày 20/10 thật nhiều niềm vui và hạnh phúc ạ!", sticker: false },
            { text: "Mẹ mãi là người phụ nữ tuyệt vời nhất trong lòng con! Yêu mẹ! ❤️", sticker: false }
        ];
        function startFanMailAnimation() {
            const messageArea = document.querySelector('.message-area');
            if(messageArea.children.length > 0) return; // Prevent re-animating
            let delay = 500;
            messages.forEach(msg => {
                setTimeout(() => {
                    const bubble = document.createElement('div');
                    bubble.classList.add('message-bubble', 'sender');
                    if (msg.sticker) { bubble.style.background = 'none'; bubble.style.fontSize = '3rem'; }
                    bubble.textContent = msg.text;
                    messageArea.appendChild(bubble);
                    setTimeout(() => bubble.classList.add('visible'), 50);
                }, delay);
                delay += 1500;
            });
        }
    });
    </script>
</body>
</html>
