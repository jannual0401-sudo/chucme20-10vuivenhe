<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>·∫§n B·∫£n ƒê·∫∑c Bi·ªát 20.10 - The Queen</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --font-title: 'Playfair+Display', serif;
            --font-body: 'Inter', sans-serif;
            --color-gold: #D4AF37;
            --color-navy: #0A192F;
            --color-light-cream: #F5F5DC;
            --color-text: #333;
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: var(--font-body);
            background-color: #1a1a1a;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 2500px;
        }
        .magazine-container {
            width: 100%;
            height: 100%;
            max-width: 1200px;
            max-height: 800px;
            position: relative;
        }

        /* --- M√ÄN R√àM KH√ìA --- */
        .curtain-wrapper {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 1000;
            overflow: hidden;
        }
        .curtain {
            position: absolute;
            top: 0;
            width: 50%;
            height: 100%;
            background: #8B0000 url('https://www.transparenttextures.com/patterns/subtle-grunge.png');
            box-shadow: inset 0 0 100px rgba(0,0,0,0.5);
            transition: transform 2s cubic-bezier(0.65, 0, 0.35, 1);
        }
        .curtain::before {
            content: '';
            position: absolute;
            top: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(0,0,0,0.4), transparent 10%, transparent 90%, rgba(0,0,0,0.4));
        }
        .left-curtain { left: 0; }
        .right-curtain { right: 0; }
        .curtain-wrapper.open .left-curtain { transform: translateX(-100%); }
        .curtain-wrapper.open .right-curtain { transform: translateX(100%); }

        /* --- M·∫¨T KH·∫®U --- */
        .password-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.5); backdrop-filter: blur(10px);
            z-index: 1001; display: flex; justify-content: center; align-items: center;
            opacity: 1; visibility: visible;
        }
        .password-box {
            background-color: var(--color-navy); color: white; padding: 40px; border-radius: 10px; text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        #password-input {
            font-size: 2rem; width: 200px; text-align: center; border: none;
            border-bottom: 2px solid var(--color-gold); background: transparent; color: white;
            letter-spacing: 20px; margin-top: 20px;
        }
        #password-input:focus { outline: none; }
        .password-box.shake { animation: shake 0.5s; }
        @keyframes shake {
            10%, 90% { transform: translateX(-5px); } 20%, 80% { transform: translateX(5px); }
            30%, 50%, 70% { transform: translateX(-3px); } 40%, 60% { transform: translateX(3px); }
        }

        /* --- HI·ªÜU ·ª®NG L·∫¨T TRANG 3D --- */
        .magazine {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            display: none; /* ·∫®n ban ƒë·∫ßu */
        }
        .page {
            width: 50%;
            height: 100%;
            position: absolute;
            top: 0;
            right: 0;
            transform-origin: left center;
            transition: transform 1.5s cubic-bezier(0.65, 0, 0.35, 1);
            transform-style: preserve-3d;
        }
        .page-content {
            width: 100%;
            height: 100%;
            position: absolute;
            background-color: var(--color-light-cream);
            backface-visibility: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
        }
        .page-front { z-index: 1; }
        .page-back { transform: rotateY(180deg); }
        .page.flipped { transform: rotateY(-180deg); }
        .page.static {
            width: 50%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        /* --- N·ªôi dung c√°c trang --- */
        .cover { justify-content: center; align-items: center; }
        .cover-layout { display: flex; width: 90%; height: 80%; align-items: center; gap: 50px; }
        .cover-image { width: 40%; height: 100%; object-fit: cover; border: 10px solid white; }
        .cover-text { flex: 1; text-align: left; }
        .magazine-title { font-family: var(--font-title); font-size: 2rem; letter-spacing: 5px; opacity: 0.8; }
        .headline { font-family: var(--font-title); font-size: 5rem; color: var(--color-gold); line-height: 1.1; margin: 20px 0; }
        
        .fashion-spread { padding: 50px; gap: 50px; }
        .fashion-left, .fashion-right { width: 50%; }
        .fashion-left h2 { font-family: var(--font-title); font-size: 4rem; color: var(--color-navy); }
        .fashion-left .quote { font-style: italic; font-size: 1.2rem; margin: 20px 0; padding-left: 20px; border-left: 3px solid var(--color-gold); }
        .fashion-right { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; align-content: center; }
        .fashion-right img { width: 100%; height: auto; object-fit: cover; box-shadow: 0 8px 20px rgba(0,0,0,0.15); }

        .game-page { background-image: linear-gradient(135deg, #0f2027, #203a43, #2c5364); color: white; justify-content: center; align-items: center; }
        #game-container { position: relative; width: 100%; height: 100%; background: rgba(0,0,0,0.3); overflow: hidden; }
        #gameCanvas { width: 100%; height: 100%; }
        #game-score { position: absolute; top: 20px; left: 20px; font-size: 2rem; font-weight: 600; }
        #game-rules-popup, #game-result { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); backdrop-filter: blur(5px); display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; z-index: 100; }
        #game-rules-popup h3, #game-result h3 { font-family: var(--font-title); font-size: 3rem; color: var(--color-gold); }
        #game-rules-popup ul { list-style: none; padding: 0; margin: 20px 0; font-size: 1.5rem; }
        #game-rules-popup button { padding: 15px 30px; font-size: 1.2rem; border: none; border-radius: 5px; background-color: var(--color-gold); color: var(--color-navy); cursor: pointer; font-weight: 600; }
        #game-result { display: none; }
        #game-result h3 { font-size: 4rem; color: #4CAF50; }

        .fan-mail-page { justify-content: center; align-items: center; background-color: #f0f2f5; }
        .chat-window { width: 400px; height: 90%; background-color: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); display: flex; flex-direction: column; }
        .chat-header { padding: 15px; text-align: center; background: var(--color-navy); color: white; border-top-left-radius: 20px; border-top-right-radius: 20px; font-weight: 600; }
        .message-area { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .message-bubble { padding: 10px 15px; border-radius: 18px; max-width: 70%; line-height: 1.5; opacity: 0; transform: translateY(20px); transition: 0.5s; }
        .message-bubble.visible { opacity: 1; transform: translateY(0); }
        .message-bubble.sender { background-color: #005C4B; color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
        
        .back-cover { flex-direction: column; justify-content: center; align-items: center; text-align: center; background-color: #e8e8e8; padding: 20px; }
        .back-cover img { width: 50%; border: 15px solid white; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .back-cover p { font-family: var(--font-title); font-size: 2rem; margin-top: 30px; color: var(--color-text); }
        .credits { font-size: 0.9rem; font-style: italic; color: #777; margin-top: 20px; }

        .nav-button { position: absolute; top: 50%; transform: translateY(-50%); z-index: 50; background: rgba(10, 25, 47, 0.7); color: white; border: none; width: 50px; height: 50px; border-radius: 50%; font-size: 2rem; cursor: pointer; display: flex; justify-content: center; align-items: center; transition: background 0.3s; }
        .nav-button:hover { background: var(--color-gold); }
        .prev-btn { left: 20px; }
        .next-btn { right: 20px; }
    </style>
</head>
<body>
    <div class="magazine-container">
        <div class="curtain-wrapper" id="curtain-wrapper">
            <div class="curtain left-curtain"></div>
            <div class="curtain right-curtain"></div>
            <div class="password-overlay" id="password-overlay">
                <div class="password-box" id="password-box">
                    <h2>M·ªü Kh√≥a M√≥n Qu√†</h2>
                    <p>Nh·∫≠p m·∫≠t kh·∫©u (ddmm)</p>
                    <input type="password" id="password-input" maxlength="4" autofocus autocomplete="off">
                </div>
            </div>
        </div>

        <div class="magazine" id="magazine">
            <div class="page static">
                <div class="page-content cover" style="background-color: var(--color-navy); color: white;">
                     <div class="cover-layout">
                        <img src="https://images.placeholders.dev/?width=600&height=800&text=·∫¢nh+th·∫ßn+th√°i+c·ªßa+M·∫π&bgColor=#E8E8E8" alt="·∫¢nh b√¨a m·∫π" class="cover-image">
                        <div class="cover-text">
                            <p class="magazine-title">THE QUEEN</p>
                            <h1 class="headline">·∫§n B·∫£n 20.10</h1>
                        </div>
                    </div>
                </div>
            </div>

            <div class="page" id="page-1">
                <div class="page-content page-front fashion-spread">
                    <div class="fashion-left">
                        <h2>Fashionista U50</h2>
                        <p class="quote">"V·∫ª ƒë·∫πp kh√¥ng n·∫±m ·ªü qu·∫ßn √°o h√†ng hi·ªáu, m√† ·ªü n·ª• c∆∞·ªùi t·ª± tin."</p>
                    </div>
                    <div class="fashion-right">
                        <img src="https://images.placeholders.dev/?width=400&height=500&text=·∫¢nh+1&bgColor=#F0F0F0" alt="·∫¢nh 1">
                        <img src="https://images.placeholders.dev/?width=400&height=500&text=·∫¢nh+2&bgColor=#F0F0F0" alt="·∫¢nh 2">
                    </div>
                </div>
                <div class="page-content page-back game-page">
                     <div id="game-container">
                        <canvas id="gameCanvas"></canvas>
                        <div id="game-score">ƒêi·ªÉm: 0</div>
                        <div id="game-rules-popup">
                            <h3>Idol Challenge</h3>
                            <ul><li>‚ù§Ô∏è = +5</li><li>‚≠ê = +10</li><li>üí£ = -5</li></ul>
                            <p>ƒê·∫°t 80 ƒëi·ªÉm ƒë·ªÉ chi·∫øn th·∫Øng!</p>
                            <button id="startGameBtn">S·∫µn s√†ng!</button>
                        </div>
                        <div id="game-result"><h3 id="result-message"></h3></div>
                     </div>
                </div>
            </div>
            
            <div class="page" id="page-2">
                <div class="page-content page-front fan-mail-page">
                    <div class="chat-window">
                        <div class="chat-header">H·ªôp Th∆∞ T·ª´ Fan C·ª©ng üíå</div>
                        <div class="message-area"></div>
                    </div>
                </div>
                <div class="page-content page-back back-cover">
                    <img src="https://images.placeholders.dev/?width=800&height=600&text=·∫¢nh+c·∫£+gia+ƒë√¨nh&bgColor=#FFFFFF" alt="·∫¢nh gia ƒë√¨nh">
                    <p>C·∫£m ∆°n 'Idol' v√¨ ƒë√£ l√† ngu·ªìn c·∫£m h·ª©ng c·ªßa c·∫£ nh√†!</p>
                    <p class="credits">Bi√™n t·∫≠p: M·ªôt m√¨nh Bi :3</p>
                </div>
            </div>
        </div>

        <button class="nav-button prev-btn" id="prev-btn">‚óÑ</button>
        <button class="nav-button next-btn" id="next-btn">‚ñ∫</button>

        <audio id="gameMusic" src="https://cdn.pixabay.com/audio/2022/08/03/audio_51cf531278.mp3" loop></audio>
        <audio id="collectSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_2b33a52239.mp3"></audio>
        <audio id="bombSound" src="https://cdn.pixabay.com/audio/2021/08/04/audio_c483740443.mp3"></audio>
        <audio id="winSound" src="https://cdn.pixabay.com/audio/2022/11/17/audio_88b22280a5.mp3"></audio>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const magazine = document.getElementById('magazine');
        const pages = document.querySelectorAll('.page:not(.static)');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        let currentPageIndex = 0;

        function updateZIndexes() {
            pages.forEach((page, i) => {
                page.style.zIndex = pages.length - i;
            });
        }
        function flipTo(pageIndex) {
            if (pageIndex < 0 || pageIndex >= pages.length) return;
            if (pageIndex > currentPageIndex) {
                for (let i = currentPageIndex; i < pageIndex; i++) {
                    pages[i].classList.add('flipped');
                }
            } else if (pageIndex < currentPageIndex) {
                for (let i = currentPageIndex - 1; i >= pageIndex; i--) {
                    pages[i].classList.remove('flipped');
                }
            }
            currentPageIndex = pageIndex;
            if(currentPageIndex === 0) document.getElementById('game-rules-popup').style.display = 'flex';
            if(currentPageIndex === 1) startFanMailAnimation();
        }
        
        prevBtn.addEventListener('click', () => flipTo(currentPageIndex - 1));
        nextBtn.addEventListener('click', () => flipTo(currentPageIndex + 1));
        updateZIndexes();

        const curtainWrapper = document.getElementById('curtain-wrapper');
        const passwordOverlay = document.getElementById('password-overlay');
        const passwordInput = document.getElementById('password-input');
        const passwordBox = document.getElementById('password-box');
        passwordInput.addEventListener('input', () => {
            if (passwordInput.value === '0901') {
                passwordOverlay.style.display = 'none';
                curtainWrapper.classList.add('open');
                setTimeout(() => {
                    magazine.style.display = 'block';
                }, 500);
            } else if (passwordInput.value.length >= 4) {
                passwordBox.classList.add('shake');
                setTimeout(() => { passwordBox.classList.remove('shake'); passwordInput.value = ''; }, 500);
            }
        });

        const gameContainer = document.getElementById('game-container');
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('game-score');
        const rulesPopup = document.getElementById('game-rules-popup');
        const resultScreen = document.getElementById('game-result');
        const resultMessage = document.getElementById('result-message');
        const gameMusic = document.getElementById('gameMusic');
        const collectSound = document.getElementById('collectSound');
        const bombSound = document.getElementById('bombSound');
        const winSound = document.getElementById('winSound');
        let score, player, items, gameLoopId;

        function resizeCanvas() {
            canvas.width = gameContainer.clientWidth;
            canvas.height = gameContainer.clientHeight;
        }
        document.getElementById('startGameBtn').addEventListener('click', () => {
            rulesPopup.style.display = 'none';
            resizeCanvas();
            startGame();
        });
        function startGame() {
            score = 0; items = [];
            gameLoopId = null;
            scoreEl.textContent = `ƒêi·ªÉm: ${score}`;
            player = { x: canvas.width / 2 - 25, y: canvas.height - 70, width: 50, height: 60, emoji: 'üé§' };
            gameMusic.play();
            const itemInterval = setInterval(spawnItem, 600);
            gameLoopId = requestAnimationFrame(gameLoop);
            setTimeout(() => { clearInterval(itemInterval); }, 25000);
        }
        function gameLoop() {
            if (!gameLoopId) return;
            updateGame();
            requestAnimationFrame(gameLoop);
        }
        const itemTypes = [{ emoji: '‚ù§Ô∏è', value: 5, type: 'good' }, { emoji: '‚≠ê', value: 10, type: 'good' }, { emoji: 'üí£', value: -5, type: 'bad' }];
        function spawnItem() {
            const type = itemTypes[Math.floor(Math.random() * itemTypes.length)];
            items.push({ x: Math.random() * (canvas.width - 40), y: -40, size: 40, speed: 2 + Math.random() * 3, ...type });
        }
        function updateGame() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.font = '50px sans-serif';
            ctx.fillText(player.emoji, player.x, player.y);
            items.forEach((item, index) => {
                item.y += item.speed;
                ctx.font = `${item.size}px sans-serif`;
                ctx.fillText(item.emoji, item.x, item.y);
                if (item.y > canvas.height) items.splice(index, 1);
                if (player.x < item.x + item.size && player.x + player.width > item.x && player.y < item.y + item.size && player.y + player.height > item.y) {
                    score = Math.max(0, score + item.value);
                    scoreEl.textContent = `ƒêi·ªÉm: ${score}`;
                    items.splice(index, 1);
                    (item.type === 'good' ? collectSound : bombSound).play();
                    if (score >= 80) endGame(true);
                }
            });
            if (items.length === 0 && gameLoopId && score < 80) { // Check if game should end
                 // endGame(false); // Can uncomment to end game if all items passed
            }
        }
        function endGame(isWin) {
            cancelAnimationFrame(gameLoopId);
            gameLoopId = null;
            gameMusic.pause();
            resultScreen.style.display = 'flex';
            resultMessage.textContent = isWin ? "XU·∫§T S·∫ÆC!" : "C·ªë L√™n N√†o!";
            if (isWin) winSound.play();
        }
        document.addEventListener('keydown', e => {
            if(!player) return;
            if (e.key === 'ArrowLeft' && player.x > 0) player.x -= 20;
            if (e.key === 'ArrowRight' && player.x < canvas.width - player.width) player.x += 20;
        });
        canvas.addEventListener('touchmove', e => {
            if(!player) return;
            e.preventDefault();
            const rect = canvas.getBoundingClientRect();
            player.x = e.touches[0].clientX - rect.left - player.width / 2;
        });

        const messages = [{ text: "Hi Mom!", sticker: false }, { text: "ü•∞", sticker: true }, { text: "Ch√∫c m·∫π 20/10 vui v·∫ª!", sticker: false }];
        function startFanMailAnimation() {
            const messageArea = document.querySelector('.message-area');
            messageArea.innerHTML = '';
            let delay = 500;
            messages.forEach(msg => {
                setTimeout(() => {
                    const bubble = document.createElement('div');
                    bubble.classList.add('message-bubble', 'sender');
                    if (msg.sticker) bubble.style.background = 'none';
                    bubble.textContent = msg.text;
                    messageArea.appendChild(bubble);
                    setTimeout(() => bubble.classList.add('visible'), 100);
                }, delay);
                delay += 1500;
            });
        }
    });
    </script>
</body>
</html>
